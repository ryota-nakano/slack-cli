# GitHub Copilot 開発ガイドライン

## 🎯 基本方針

このプロジェクトでは**効率的で正確な問題解決**を重視します。

## 🔍 デバッグファーストアプローチ

問題が報告されたら、推測ではなく**実際のデータ**で原因を特定します。

### 手順

1. **問題報告を受けたら**
   - すぐに修正しない
   - まずデバッグ情報を収集する
   - 必要に応じてデバッグログの実行をお願いする

2. **ログ分析**
   - 実際の動作を確認
   - 変数の値を追跡
   - 処理の流れを把握
   - 根本原因を特定

3. **最小限の修正**
   - 特定した原因だけを修正
   - 不要な変更はしない
   - テストで動作確認

4. **クリーンアップ**
   - デバッグコードを削除
   - コメントを整理
   - コミット

### デバッグ手法

```javascript
// 問題箇所に一時的なデバッグログを追加
if (process.env.DEBUG_FEATURE) {
  console.error(`[DEBUG] 変数名: ${変数}`);
  console.error(`[DEBUG] 状態: ${JSON.stringify(状態)}`);
}
```

実行時:
```bash
DEBUG_FEATURE=1 npm start
```

## ⚠️ やってはいけないこと

- ❌ 推測だけで修正する
- ❌ 複数箇所を同時に変更する
- ❌ デバッグせずに「多分これが原因」と判断する
- ❌ 動作確認せずにコミットする

## ✅ やるべきこと

- ✅ デバッグログで実際の動作を確認
- ✅ 原因を特定してから修正
- ✅ 最小限の変更で問題を解決
- ✅ テストで動作確認
- ✅ デバッグコードを削除してクリーンアップ

## 🎓 教訓

### 今回の学び（v2.2.x系バグ修正より）

**問題**: Ctrl+J改行で行が増殖する

**悪い対応**:
```javascript
// 推測で色々変更
// → 何度も修正が必要になった
```

**良い対応**:
```javascript
// デバッグログで実際の値を確認
if (process.env.DEBUG_READLINE) {
  console.error(`[DEBUG] screenCursorLine: ${this.screenCursorLine}`);
  console.error(`[DEBUG] currentLineIdx: ${currentLineIdx}`);
}
// → 一発で根本原因を特定できた
```

**結果**: デバッグログで`screenCursorLine`が更新されていないことが判明 → 1箇所の修正で完璧に動作

## 📋 チェックリスト

問題修正時は以下を確認:

- [ ] デバッグログで実際の動作を確認したか？
- [ ] 根本原因を特定したか？
- [ ] 最小限の変更で修正したか？
- [ ] テストで動作確認したか？
- [ ] デバッグコードを削除したか？
- [ ] 関連ドキュメントを更新したか？

## 🚀 効率化のポイント

1. **早期のデバッグ**: 最初にデバッグ → 時間短縮
2. **データ駆動**: 推測より実データ → 正確
3. **最小変更**: 必要最小限の修正 → 安全
4. **段階的確認**: 修正後すぐテスト → 早期発見

## 💡 まとめ

**「デバッグファーストで効率的に問題解決！」**

- 推測ではなく実データで判断
- 最小限の変更で正確に修正
- テストとクリーンアップを忘れずに

このアプローチで、品質の高いコードを効率的に開発できます。
